# Функция выбора размера данных в командной строке

## Обзор

Добавлена возможность выбора размера данных для шифрования через параметры командной строки.

### Что добавлено

- **Параметр `mode`** для task 0: выбор между демо-текстом и случайными данными
- **Параметр `data_size_kb`**: размер данных от 1 КБ до 100 МБ (100000 КБ)
- **Измерение пропускной способности**: автоматический расчет MB/s
- **Hex-вывод**: отображение первых 64 байт для проверки

## Синтаксис командной строки

```
./wbc1_original_parallel <task> <key_size> <key_source> <block_size_bits> [mode] [data_size_kb]

Параметры:
  task            - 0: шифрование/дешифрование, 1: статистические тесты
  key_size        - размер ключа в битах (128, 192, 256)
  key_source      - 0: случайный ключ, 1: из файла
  block_size_bits - размер блока (32, 64, 128, 512)
  mode            - (для task 0) 0: демо-текст, 1: случайные данные
                    (для task 1) 0: простой режим, 1: полный режим
  data_size_kb    - размер данных в КБ (1-100000)
```

## Примеры использования

### 1. Демо-текст (оригинальное поведение)

```bash
# Шифрование фиксированного демо-текста
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128
```

### 2. Малые данные (1-10 КБ)

```bash
# Шифрование 1 КБ случайных данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 1

# Шифрование 10 КБ данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 10
```

### 3. Средние данные (100-1000 КБ)

```bash
# Шифрование 100 КБ для бенчмарка
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 100

# Шифрование 500 КБ данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 500

# Шифрование 1 МБ (1000 КБ)
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 1000
```

### 4. Большие данные (1-10 МБ)

```bash
# Шифрование 5 МБ для теста пропускной способности
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 5000

# Шифрование максимальных 10 МБ
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 10000
```

### 5. Разные размеры блоков

```bash
# 32-битные блоки, 10 КБ данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 32 1 10

# 64-битные блоки, 100 КБ данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 64 1 100

# 512-битные блоки, 1 МБ данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 512 1 1000
```

## Особенности вывода

### Режим демо-текста (mode=0)

```
========================================
WBC1 Original Algorithm - Text Encryption Demo
========================================
Mode: Demo text
Original text: Це тестове повідомлення...
Block size: 128 bits (16 bytes)
Key size: 256 bits
Cube dimension: 2×2×4
Key bits processed: 256

Encrypted (96 bytes):
4f3e2d1c5b6a7988...

Decrypted text: Це тестове повідомлення...

Encryption time: 0.000123 seconds
Decryption time: 0.000118 seconds
✓ Success: Decrypted data matches original!
```

### Режим случайных данных (mode=1)

```
========================================
WBC1 Original Algorithm - Random Data Encryption
========================================
Mode: Random data
Data size: 100 KB (102400 bytes)
First 64 bytes of plaintext:
a3f1c8e9d4b7f2c1e8d9a4b3c7f1e2d8...

Block size: 128 bits (16 bytes)
Key size: 256 bits
Cube dimension: 2×2×4
Key bits processed: 256

Encrypted (102400 bytes):
7e4d3c2b1a9f8e7d6c5b4a39281f...

Decrypted (102400 bytes), first 64 bytes:
a3f1c8e9d4b7f2c1e8d9a4b3c7f1e2d8...

Encryption time: 0.089432 seconds
Decryption time: 0.088791 seconds
Throughput: 1.09 MB/s
✓ Success: Decrypted data matches original!
```

## Тестирование производительности

### Быстрые тесты (1-10 КБ)

Подходит для:
- Проверки корректности алгоритма
- Быстрой проверки изменений
- Отладки

```bash
mpirun -n 1 ./wbc1_original_parallel 0 256 0 128 1 1
mpirun -n 1 ./wbc1_original_parallel 0 256 0 128 1 10
```

### Стандартные бенчмарки (100-1000 КБ)

Подходит для:
- Сравнения с другими алгоритмами
- Оценки производительности
- Тестирования на типичных объемах данных

```bash
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 100
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 500
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 1000
```

### Тесты пропускной способности (1-10 МБ)

Подходит для:
- Измерения максимальной пропускной способности
- Тестирования MPI параллелизма
- Оценки масштабируемости

```bash
mpirun -n 8 ./wbc1_original_parallel 0 256 0 128 1 5000
mpirun -n 16 ./wbc1_original_parallel 0 256 0 128 1 10000
```

## Технические детали

### Генерация случайных данных

Функция `generate_random_bytes()` использует:
- `/dev/urandom` на Unix/Linux системах
- `rand()` с инициализацией по времени как запасной вариант
- Генерирует криптографически стойкие случайные данные

### Ограничения

- **Минимальный размер**: 1 КБ (1024 байта)
- **Максимальный размер**: 100 МБ (100000 КБ = 102400000 байт)
- **Память**: Выделяется динамически для каждого теста
- **MPI**: Данные распределяются между процессами автоматически

### Обработка блоков

1. Данные разбиваются на блоки фиксированного размера
2. Каждый блок шифруется независимо
3. Дополнение (padding) применяется к последнему блоку при необходимости
4. MPI процессы обрабатывают блоки параллельно

## Обратная совместимость

### Старые команды работают без изменений

```bash
# Работает как раньше - использует демо-текст
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128
```

### Новые параметры опциональны

- `mode` по умолчанию = 0 (демо-текст)
- `data_size_kb` используется только при mode=1

### Поведение по умолчанию

Если параметры не указаны:
- Task 0: использует демо-текст (как раньше)
- Task 1: использует 10 КБ данных для статистики (как раньше)

## Сравнение: До и После

### До (оригинальная версия)

```bash
# Только демо-текст, фиксированный размер
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128
```

Ограничения:
- ❌ Нельзя изменить размер данных
- ❌ Нельзя тестировать производительность
- ❌ Только один вариант текста

### После (новая версия)

```bash
# Демо-текст (обратная совместимость)
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128

# Любой размер данных
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 10
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 100
mpirun -n 4 ./wbc1_original_parallel 0 256 0 128 1 1000
```

Преимущества:
- ✅ Гибкий выбор размера данных (1 КБ - 10 МБ)
- ✅ Тестирование производительности
- ✅ Измерение пропускной способности
- ✅ Hex-вывод для проверки
- ✅ Обратная совместимость

## Заключение

Функция выбора размера данных добавляет гибкость и позволяет:
- Тестировать алгоритм с разными объемами данных
- Измерять производительность и пропускную способность
- Сравнивать с другими реализациями
- Проводить бенчмаркинг

При этом сохраняется полная обратная совместимость со старыми командами.
